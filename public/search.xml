<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[axioså…¨æ”»ç•¥]]></title>
      <url>http://ygxdxx.coding.me/2017/02/27/axios%E5%85%A8%E6%94%BB%E7%95%A5/</url>
      <content type="html"><![CDATA[<h1 id="axioså…¨æ”»ç•¥"><a href="#axioså…¨æ”»ç•¥" class="headerlink" title="axioså…¨æ”»ç•¥"></a>axioså…¨æ”»ç•¥</h1><blockquote>
<p>axios æ˜¯ä¸€ä¸ªåŸºäºPromise ç”¨äºæµè§ˆå™¨å’Œ nodejs çš„ HTTP å®¢æˆ·ç«¯ï¼Œå®ƒæœ¬èº«å…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š</p>
</blockquote>
<ul>
<li>ä»æµè§ˆå™¨ä¸­åˆ›å»º XMLHttpRequest</li>
<li>ä» node.js å‘å‡º http è¯·æ±‚</li>
<li>æ”¯æŒ Promise API</li>
<li>æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li>
<li>è½¬æ¢è¯·æ±‚å’Œå“åº”æ•°æ®</li>
<li>å–æ¶ˆè¯·æ±‚</li>
<li>è‡ªåŠ¨è½¬æ¢JSONæ•°æ®</li>
<li>å®¢æˆ·ç«¯æ”¯æŒé˜²æ­¢ CSRF/XSRF</li>
</ul>
<h1 id="å¼•å…¥æ–¹å¼"><a href="#å¼•å…¥æ–¹å¼" class="headerlink" title="å¼•å…¥æ–¹å¼"></a>å¼•å…¥æ–¹å¼</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">$ npm install axios</div><div class="line">$ cnpm install axios <span class="comment">/*taobaoæº*/</span></div><div class="line">$ bower install axios</div><div class="line">æˆ–è€…ä½¿ç”¨cdnï¼š</div><div class="line">&lt;script src=<span class="string">"https:/*unpkg.com/axios/dist/axios.min.js"</span>&gt;&lt;/script&gt;</div></pre></td></tr></table></figure>
<h1 id="ä¾‹å­"><a href="#ä¾‹å­" class="headerlink" title="ä¾‹å­"></a>ä¾‹å­</h1><h2 id="æ‰§è¡Œ-GET-è¯·æ±‚"><a href="#æ‰§è¡Œ-GET-è¯·æ±‚" class="headerlink" title="æ‰§è¡Œ GET è¯·æ±‚"></a>æ‰§è¡Œ GET è¯·æ±‚</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* å‘å…·æœ‰æŒ‡å®šIDçš„ç”¨æˆ·å‘å‡ºè¯·æ±‚ */</span></div><div class="line">axios.get(<span class="string">'/user?ID=12345'</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(error);</div><div class="line">  &#125;);</div><div class="line"><span class="comment">/* ä¹Ÿå¯ä»¥é€šè¿‡ params å¯¹è±¡ä¼ é€’å‚æ•°*/</span></div><div class="line">axios.get(<span class="string">'/user'</span>, &#123;</div><div class="line">    <span class="attr">params</span>: &#123;</div><div class="line">      <span class="attr">ID</span>: <span class="number">12345</span></div><div class="line">    &#125;</div><div class="line">  &#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<h2 id="æ‰§è¡Œ-POST-è¯·æ±‚"><a href="#æ‰§è¡Œ-POST-è¯·æ±‚" class="headerlink" title="æ‰§è¡Œ POST è¯·æ±‚"></a>æ‰§è¡Œ POST è¯·æ±‚</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">axios.post(<span class="string">'/user'</span>, &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Fred'</span>,</div><div class="line">    <span class="attr">lastName</span>: <span class="string">'Flintstone'</span></div><div class="line">  &#125;)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure>
<h2 id="æ‰§è¡Œå¤šä¸ªå¹¶å‘è¯·æ±‚"><a href="#æ‰§è¡Œå¤šä¸ªå¹¶å‘è¯·æ±‚" class="headerlink" title="æ‰§è¡Œå¤šä¸ªå¹¶å‘è¯·æ±‚"></a>æ‰§è¡Œå¤šä¸ªå¹¶å‘è¯·æ±‚</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserAccount</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345'</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getUserPermissions</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> axios.get(<span class="string">'/user/12345/permissions'</span>);</div><div class="line">&#125;</div><div class="line">axios.all([getUserAccount(), getUserPermissions()])</div><div class="line">    <span class="comment">/* ä¸¤ä¸ªè¯·æ±‚ç°å·²å®Œæˆ  */</span></div><div class="line">  .then(axios.spread(<span class="function"><span class="keyword">function</span> (<span class="params">acct, perms</span>) </span>&#123;</div><div class="line"></div><div class="line">  &#125;)</div><div class="line">);</div></pre></td></tr></table></figure>
<h1 id="axios-API"><a href="#axios-API" class="headerlink" title="axios API"></a>axios API</h1><p>å¯ä»¥é€šè¿‡å°†ç›¸å…³é…ç½®ä¼ é€’ç»™ axios æ¥è¿›è¡Œè¯·æ±‚ã€‚</p>
<h2 id="axios-config"><a href="#axios-config" class="headerlink" title="axios(config)"></a>axios(config)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* å‘é€ä¸€ä¸ª POST è¯·æ±‚*/</span></div><div class="line">axios(&#123;</div><div class="line">  <span class="attr">method</span>: <span class="string">'post'</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'/user/12345'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Fred'</span>,</div><div class="line">    <span class="attr">lastName</span>: <span class="string">'Flintstone'</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="axios-url-config"><a href="#axios-url-config" class="headerlink" title="axios(url[, config])"></a>axios(url[, config])</h2><p>å‘é€ä¸€ä¸ª GET è¯·æ±‚ (GETè¯·æ±‚æ˜¯é»˜è®¤è¯·æ±‚æ¨¡å¼)<br>axios(â€˜/user/12345â€™);</p>
<h2 id="è¯·æ±‚æ–¹æ³•åˆ«å"><a href="#è¯·æ±‚æ–¹æ³•åˆ«å" class="headerlink" title="è¯·æ±‚æ–¹æ³•åˆ«å"></a>è¯·æ±‚æ–¹æ³•åˆ«å</h2><p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œå·²ç»ä¸ºæ‰€æœ‰æ”¯æŒçš„è¯·æ±‚æ–¹æ³•æä¾›äº†åˆ«åã€‚</p>
<ul>
<li>axios.request(config)</li>
<li>axios.get(url [ï¼Œconfig])</li>
<li>axios.delete(url [ï¼Œconfig])</li>
<li>axios.head(url [ï¼Œconfig])</li>
<li>axios.post(url [ï¼Œdata [ï¼Œconfig]])</li>
<li>axios.put(url [ï¼Œdata [ï¼Œconfig]])</li>
<li>axios.patch(url [ï¼Œdata [ï¼Œconfig]])</li>
</ul>
<h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>å½“ä½¿ç”¨åˆ«åæ–¹æ³•æ—¶ï¼Œä¸éœ€è¦åœ¨configä¸­æŒ‡å®šurlï¼Œmethodå’Œdataå±æ€§ã€‚</p>
<h2 id="å¹¶å‘"><a href="#å¹¶å‘" class="headerlink" title="å¹¶å‘"></a>å¹¶å‘</h2><p>å¸®åŠ©å‡½æ•°å¤„ç†å¹¶å‘è¯·æ±‚ã€‚</p>
<ul>
<li>axios.all(iterable)</li>
<li>axios.spread(callback)</li>
</ul>
<h2 id="åˆ›å»ºå®ä¾‹"><a href="#åˆ›å»ºå®ä¾‹" class="headerlink" title="åˆ›å»ºå®ä¾‹"></a>åˆ›å»ºå®ä¾‹</h2><p>æ‚¨å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰é…ç½®åˆ›å»ºaxiosçš„æ–°å®ä¾‹ã€‚</p>
<p>axios.create([config])</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> instance = axios.create(&#123;</div><div class="line">  <span class="attr">baseURL</span>: <span class="string">'https:/*some-domain.com/api/'</span>,</div><div class="line">  <span class="attr">timeout</span>: <span class="number">1000</span>,</div><div class="line">  <span class="attr">headers</span>: &#123;<span class="string">'X-Custom-Header'</span>: <span class="string">'foobar'</span>&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="å®ä¾‹æ–¹æ³•"><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h2><p>å¯ç”¨çš„å®ä¾‹æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚ æŒ‡å®šçš„é…ç½®å°†ä¸å®ä¾‹é…ç½®åˆå¹¶ã€‚</p>
<ul>
<li>axiosï¼ƒrequest(config)</li>
<li>axiosï¼ƒget(url [ï¼Œconfig])</li>
<li>axiosï¼ƒdelete(url [ï¼Œconfig])</li>
<li>axiosï¼ƒhead(url [ï¼Œconfig])</li>
<li>axiosï¼ƒpost(url [ï¼Œdata [ï¼Œconfig]])</li>
<li>axiosï¼ƒput(url [ï¼Œdata [ï¼Œconfig]])</li>
<li>axiosï¼ƒpatch(url [ï¼Œdata [ï¼Œconfig]])</li>
</ul>
<h1 id="è¯·æ±‚é…ç½®"><a href="#è¯·æ±‚é…ç½®" class="headerlink" title="è¯·æ±‚é…ç½®"></a>è¯·æ±‚é…ç½®</h1><p>è¿™äº›æ˜¯ç”¨äºå‘å‡ºè¯·æ±‚çš„å¯ç”¨é…ç½®é€‰é¡¹ã€‚ åªæœ‰urlæ˜¯å¿…éœ€çš„ã€‚ å¦‚æœæœªæŒ‡å®šæ–¹æ³•ï¼Œè¯·æ±‚å°†é»˜è®¤ä¸ºGETã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">  <span class="comment">/* `url`æ˜¯å°†ç”¨äºè¯·æ±‚çš„æœåŠ¡å™¨URL*/</span></div><div class="line">  url: <span class="string">'/user'</span>,</div><div class="line">  <span class="comment">/* `method`æ˜¯å‘å‡ºè¯·æ±‚æ—¶ä½¿ç”¨çš„è¯·æ±‚æ–¹æ³• */</span></div><div class="line">  method: <span class="string">'get'</span>, <span class="comment">/* é»˜è®¤*/</span></div><div class="line">  <span class="comment">/* `baseURL`å°†è¢«æ·»åŠ åˆ°`url`å‰é¢ï¼Œé™¤é`url`æ˜¯ç»å¯¹çš„ã€‚*/</span></div><div class="line">  <span class="comment">/* å¯ä»¥æ–¹ä¾¿åœ°ä¸º axios çš„å®ä¾‹è®¾ç½®`baseURL`ï¼Œä»¥ä¾¿å°†ç›¸å¯¹ URL ä¼ é€’ç»™è¯¥å®ä¾‹çš„æ–¹æ³•ã€‚*/</span></div><div class="line">  baseURL: <span class="string">'https:/*some-domain.com/api/'</span>,</div><div class="line">  <span class="comment">/* `transformRequest`å…è®¸åœ¨è¯·æ±‚æ•°æ®å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰å¯¹å…¶è¿›è¡Œæ›´æ”¹*/</span></div><div class="line">  <span class="comment">/* è¿™åªé€‚ç”¨äºè¯·æ±‚æ–¹æ³•'PUT'ï¼Œ'POST'å’Œ'PATCH'*/</span></div><div class="line">  <span class="comment">/* æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå‡½æ•°å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸€ä¸ª ArrayBufferæˆ–ä¸€ä¸ª Stream*/</span></div><div class="line">  transformRequest: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="comment">/* åšä»»ä½•ä½ æƒ³è¦çš„æ•°æ®è½¬æ¢*/</span></div><div class="line">    <span class="keyword">return</span> data;</div><div class="line">  &#125;],</div><div class="line">  <span class="comment">/* `transformResponse`å…è®¸åœ¨ then / catchä¹‹å‰å¯¹å“åº”æ•°æ®è¿›è¡Œæ›´æ”¹*/</span></div><div class="line">  transformResponse: [<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</div><div class="line">    <span class="comment">/* Do whatever you want to transform the data*/</span></div><div class="line">    <span class="keyword">return</span> data;</div><div class="line">  &#125;],</div><div class="line">  <span class="comment">/* `headers`æ˜¯è¦å‘é€çš„è‡ªå®šä¹‰ headers*/</span></div><div class="line">  headers: &#123;<span class="string">'X-Requested-With'</span>: <span class="string">'XMLHttpRequest'</span>&#125;,</div><div class="line">  <span class="comment">/* `params`æ˜¯è¦ä¸è¯·æ±‚ä¸€èµ·å‘é€çš„URLå‚æ•°*/</span></div><div class="line">  <span class="comment">/* å¿…é¡»æ˜¯çº¯å¯¹è±¡æˆ–URLSearchParamså¯¹è±¡*/</span></div><div class="line">  params: &#123;</div><div class="line">    <span class="attr">ID</span>: <span class="number">12345</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `paramsSerializer`æ˜¯ä¸€ä¸ªå¯é€‰çš„å‡½æ•°ï¼Œè´Ÿè´£åºåˆ—åŒ–`params`*/</span></div><div class="line">  <span class="comment">/* (e.g. https:/*www.npmjs.com/package/qs, http:/*api.jquery.com/jquery.param/)*/</span></div><div class="line">  paramsSerializer: <span class="function"><span class="keyword">function</span>(<span class="params">params</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> Qs.stringify(params, &#123;<span class="attr">arrayFormat</span>: <span class="string">'brackets'</span>&#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `data`æ˜¯è¦ä½œä¸ºè¯·æ±‚ä¸»ä½“å‘é€çš„æ•°æ®*/</span></div><div class="line">  <span class="comment">/* ä»…é€‚ç”¨äºè¯·æ±‚æ–¹æ³•â€œPUTâ€ï¼Œâ€œPOSTâ€å’Œâ€œPATCHâ€*/</span></div><div class="line">  <span class="comment">/* å½“æ²¡æœ‰è®¾ç½®`transformRequest`æ—¶ï¼Œå¿…é¡»æ˜¯ä»¥ä¸‹ç±»å‹ä¹‹ä¸€ï¼š*/</span></div><div class="line">  <span class="comment">/* - string, plain object, ArrayBuffer, ArrayBufferView, URLSearchParams*/</span></div><div class="line">  <span class="comment">/* - Browser only: FormData, File, Blob*/</span></div><div class="line">  <span class="comment">/* - Node only: Stream*/</span></div><div class="line">  data: &#123;</div><div class="line">    <span class="attr">firstName</span>: <span class="string">'Fred'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `timeout`æŒ‡å®šè¯·æ±‚è¶…æ—¶ä¹‹å‰çš„æ¯«ç§’æ•°ã€‚*/</span></div><div class="line">  <span class="comment">/* å¦‚æœè¯·æ±‚çš„æ—¶é—´è¶…è¿‡'timeout'ï¼Œè¯·æ±‚å°†è¢«ä¸­æ­¢ã€‚*/</span></div><div class="line">  timeout: <span class="number">1000</span>,</div><div class="line">  <span class="comment">/* `withCredentials`æŒ‡ç¤ºæ˜¯å¦è·¨ç«™ç‚¹è®¿é—®æ§åˆ¶è¯·æ±‚*/</span></div><div class="line">  <span class="comment">/* should be made using credentials*/</span></div><div class="line">  withCredentials: <span class="literal">false</span>, <span class="comment">/* default*/</span></div><div class="line">  <span class="comment">/* `adapter'å…è®¸è‡ªå®šä¹‰å¤„ç†è¯·æ±‚ï¼Œè¿™ä½¿å¾—æµ‹è¯•æ›´å®¹æ˜“ã€‚*/</span></div><div class="line">  <span class="comment">/* è¿”å›ä¸€ä¸ªpromiseå¹¶æä¾›ä¸€ä¸ªæœ‰æ•ˆçš„å“åº”(å‚è§[response docs](ï¼ƒresponse-api))*/</span></div><div class="line">  adapter: <span class="function"><span class="keyword">function</span> (<span class="params">config</span>) </span>&#123;</div><div class="line">    <span class="comment">/* ... */</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `auth'è¡¨ç¤ºåº”è¯¥ä½¿ç”¨ HTTP åŸºæœ¬è®¤è¯ï¼Œå¹¶æä¾›å‡­æ®ã€‚*/</span></div><div class="line">  <span class="comment">/* è¿™å°†è®¾ç½®ä¸€ä¸ª`Authorization'å¤´ï¼Œè¦†ç›–ä»»ä½•ç°æœ‰çš„`Authorization'è‡ªå®šä¹‰å¤´ï¼Œä½¿ç”¨`headers`è®¾ç½®ã€‚*/</span></div><div class="line">  auth: &#123;</div><div class="line">    <span class="attr">username</span>: <span class="string">'janedoe'</span>,</div><div class="line">    <span class="attr">password</span>: <span class="string">'s00pers3cret'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* â€œresponseTypeâ€è¡¨ç¤ºæœåŠ¡å™¨å°†å“åº”çš„æ•°æ®ç±»å‹*/</span></div><div class="line">  <span class="comment">/* åŒ…æ‹¬ 'arraybuffer', 'blob', 'document', 'json', 'text', 'stream'</span></div><div class="line">  responseType: 'json', /* default*/</div><div class="line">  <span class="comment">/*`xsrfCookieName`æ˜¯è¦ç”¨ä½œ xsrf ä»¤ç‰Œçš„å€¼çš„cookieçš„åç§°*/</span></div><div class="line">  xsrfCookieName: <span class="string">'XSRF-TOKEN'</span>, <span class="comment">/* default*/</span></div><div class="line">  <span class="comment">/* `xsrfHeaderName`æ˜¯æºå¸¦xsrfä»¤ç‰Œå€¼çš„httpå¤´çš„åç§°*/</span></div><div class="line">  xsrfHeaderName: <span class="string">'X-XSRF-TOKEN'</span>, <span class="comment">/* default*/</span></div><div class="line">  <span class="comment">/* `onUploadProgress`å…è®¸å¤„ç†ä¸Šä¼ çš„è¿›åº¦äº‹ä»¶*/</span></div><div class="line">  onUploadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</div><div class="line">    <span class="comment">/* ä½¿ç”¨æœ¬åœ° progress äº‹ä»¶åšä»»ä½•ä½ æƒ³è¦åšçš„*/</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `onDownloadProgress`å…è®¸å¤„ç†ä¸‹è½½çš„è¿›åº¦äº‹ä»¶*/</span></div><div class="line">  onDownloadProgress: <span class="function"><span class="keyword">function</span> (<span class="params">progressEvent</span>) </span>&#123;</div><div class="line">    <span class="comment">/* Do whatever you want with the native progress event*/</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* `maxContentLength`å®šä¹‰å…è®¸çš„httpå“åº”å†…å®¹çš„æœ€å¤§å¤§å°*/</span></div><div class="line">  maxContentLength: <span class="number">2000</span>,</div><div class="line">  <span class="comment">/* `validateStatus`å®šä¹‰æ˜¯å¦è§£ææˆ–æ‹’ç»ç»™å®šçš„promise*/</span></div><div class="line">  <span class="comment">/* HTTPå“åº”çŠ¶æ€ç ã€‚å¦‚æœ`validateStatus`è¿”å›`true`(æˆ–è¢«è®¾ç½®ä¸º`null` promiseå°†è¢«è§£æ;å¦åˆ™ï¼Œpromiseå°†è¢«*/</span></div><div class="line">  <span class="comment">/* æ‹’ç»ã€‚*/</span></div><div class="line">  validateStatus: <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> status &gt;= <span class="number">200</span> &amp;&amp; status &lt; <span class="number">300</span>; <span class="comment">/* default</span></div><div class="line">  &#125;,</div><div class="line">  /* `maxRedirects`å®šä¹‰åœ¨node.jsä¸­è¦éµå¾ªçš„é‡å®šå‘çš„æœ€å¤§æ•°é‡ã€‚*/</div><div class="line">  <span class="comment">/* å¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™ä¸ä¼šéµå¾ªé‡å®šå‘ã€‚*/</span></div><div class="line">  maxRedirects: <span class="number">5</span>, <span class="comment">/* é»˜è®¤*/</span></div><div class="line">  <span class="comment">/* `httpAgent`å’Œ`httpsAgent`ç”¨äºå®šä¹‰åœ¨node.jsä¸­åˆ†åˆ«æ‰§è¡Œhttpå’Œhttpsè¯·æ±‚æ—¶ä½¿ç”¨çš„è‡ªå®šä¹‰ä»£ç†ã€‚*/</span></div><div class="line">  <span class="comment">/* å…è®¸é…ç½®ç±»ä¼¼`keepAlive`çš„é€‰é¡¹ï¼Œ*/</span></div><div class="line">  <span class="comment">/* é»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨ã€‚*/</span></div><div class="line">  httpAgent: <span class="keyword">new</span> http.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</div><div class="line">  <span class="attr">httpsAgent</span>: <span class="keyword">new</span> https.Agent(&#123; <span class="attr">keepAlive</span>: <span class="literal">true</span> &#125;),</div><div class="line">  <span class="comment">/* 'proxy'å®šä¹‰ä»£ç†æœåŠ¡å™¨çš„ä¸»æœºåå’Œç«¯å£*/</span></div><div class="line">  <span class="comment">/* `auth`è¡¨ç¤ºHTTP Basic authåº”è¯¥ç”¨äºè¿æ¥åˆ°ä»£ç†ï¼Œå¹¶æä¾›credentialsã€‚*/</span></div><div class="line">  <span class="comment">/* è¿™å°†è®¾ç½®ä¸€ä¸ª`Proxy-Authorization` headerï¼Œè¦†ç›–ä»»ä½•ä½¿ç”¨`headers`è®¾ç½®çš„ç°æœ‰çš„`Proxy-Authorization` è‡ªå®šä¹‰ headersã€‚*/</span></div><div class="line">  proxy: &#123;</div><div class="line">    <span class="attr">host</span>: <span class="string">'127.0.0.1'</span>,</div><div class="line">    <span class="attr">port</span>: <span class="number">9000</span>,</div><div class="line">    <span class="attr">auth</span>: : &#123;</div><div class="line">      <span class="attr">username</span>: <span class="string">'mikeymike'</span>,</div><div class="line">      <span class="attr">password</span>: <span class="string">'rapunz3l'</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">/* â€œcancelTokenâ€æŒ‡å®šå¯ç”¨äºå–æ¶ˆè¯·æ±‚çš„å–æ¶ˆä»¤ç‰Œ*/</span></div><div class="line">  <span class="comment">/* (see Cancellation section below for details)*/</span></div><div class="line">  cancelToken: <span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> (<span class="params">cancel</span>) </span>&#123;</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ then æ—¶ï¼Œæ‚¨å°†æ”¶åˆ°å¦‚ä¸‹å“åº”ï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">axios.get(<span class="string">'/user/12345'</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response.data);</div><div class="line">    <span class="built_in">console</span>.log(response.status);</div><div class="line">    <span class="built_in">console</span>.log(response.statusText);</div><div class="line">    <span class="built_in">console</span>.log(response.headers);</div><div class="line">    <span class="built_in">console</span>.log(response.config);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h1 id="é…ç½®é»˜è®¤å€¼"><a href="#é…ç½®é»˜è®¤å€¼" class="headerlink" title="é…ç½®é»˜è®¤å€¼"></a>é…ç½®é»˜è®¤å€¼</h1><p>æ‚¨å¯ä»¥æŒ‡å®šå°†åº”ç”¨äºæ¯ä¸ªè¯·æ±‚çš„é…ç½®é»˜è®¤å€¼ã€‚</p>
<h2 id="å…¨å±€axiosé»˜è®¤å€¼"><a href="#å…¨å±€axiosé»˜è®¤å€¼" class="headerlink" title="å…¨å±€axiosé»˜è®¤å€¼"></a>å…¨å±€axiosé»˜è®¤å€¼</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">axios.defaults.baseURL = <span class="string">'https:/*api.example.com'</span>;</div><div class="line">axios.defaults.headers.common[<span class="string">'Authorization'</span>] = AUTH_TOKEN;</div><div class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span>;</div></pre></td></tr></table></figure>
<h2 id="è‡ªå®šä¹‰å®ä¾‹é»˜è®¤å€¼"><a href="#è‡ªå®šä¹‰å®ä¾‹é»˜è®¤å€¼" class="headerlink" title="è‡ªå®šä¹‰å®ä¾‹é»˜è®¤å€¼"></a>è‡ªå®šä¹‰å®ä¾‹é»˜è®¤å€¼</h2><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">/*åœ¨åˆ›å»ºå®ä¾‹æ—¶è®¾ç½®é…ç½®é»˜è®¤å€¼*/</div><div class="line">var instance = axios.create(&#123;</div><div class="line">   baseURLï¼š'https:/*api.example.com'*/</div><div class="line">&#125;);</div><div class="line"></div><div class="line"> </div><div class="line">/*åœ¨å®ä¾‹åˆ›å»ºåæ”¹å˜é»˜è®¤å€¼*/</div><div class="line">instance.defaults.headers.common ['Authorization'] = AUTH_TOKEN;</div></pre></td></tr></table></figure>
<h2 id="é…ç½®ä¼˜å…ˆçº§é¡ºåº"><a href="#é…ç½®ä¼˜å…ˆçº§é¡ºåº" class="headerlink" title="é…ç½®ä¼˜å…ˆçº§é¡ºåº"></a>é…ç½®ä¼˜å…ˆçº§é¡ºåº</h2><p>é…ç½®å°†ä¸ä¼˜å…ˆé¡ºåºåˆå¹¶ã€‚ é¡ºåºæ˜¯lib / defaults.jsä¸­çš„åº“é»˜è®¤å€¼ï¼Œç„¶åæ˜¯å®ä¾‹çš„defaultså±æ€§ï¼Œæœ€åæ˜¯è¯·æ±‚çš„configå‚æ•°ã€‚ åè€…å°†ä¼˜å…ˆäºå‰è€…ã€‚ è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*ä½¿ç”¨åº“æä¾›çš„é…ç½®é»˜è®¤å€¼åˆ›å»ºå®ä¾‹*/</span></div><div class="line"><span class="comment">/*æ­¤æ—¶ï¼Œè¶…æ—¶é…ç½®å€¼ä¸º`0`ï¼Œè¿™æ˜¯åº“çš„é»˜è®¤å€¼*/</span></div><div class="line"><span class="keyword">var</span> instance = axios.create();</div><div class="line"> </div><div class="line"><span class="comment">/*è¦†ç›–åº“çš„è¶…æ—¶é»˜è®¤å€¼*/</span></div><div class="line"><span class="comment">/*ç°åœ¨æ‰€æœ‰è¯·æ±‚å°†åœ¨è¶…æ—¶å‰ç­‰å¾…2.5ç§’*/</span></div><div class="line">instance.defaults.timeout = <span class="number">2500</span>;</div><div class="line"> </div><div class="line"><span class="comment">/*è¦†ç›–æ­¤è¯·æ±‚çš„è¶…æ—¶ï¼Œå› ä¸ºå®ƒçŸ¥é“éœ€è¦å¾ˆé•¿æ—¶é—´*/</span></div><div class="line">instance.get(<span class="string">'/ longRequest'</span>ï¼Œ&#123;</div><div class="line">   timeoutï¼š<span class="number">5000</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="æ‹¦æˆªå™¨"><a href="#æ‹¦æˆªå™¨" class="headerlink" title="æ‹¦æˆªå™¨"></a>æ‹¦æˆªå™¨</h1><p>ä½ å¯ä»¥æˆªå–è¯·æ±‚æˆ–å“åº”åœ¨è¢« then æˆ–è€… catch å¤„ç†ä¹‹å‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*æ·»åŠ è¯·æ±‚æ‹¦æˆªå™¨*/</span></div><div class="line">axios.interceptors.request.use(<span class="function"><span class="keyword">function</span>(<span class="params">config</span>)</span>&#123;</div><div class="line">     <span class="comment">/*åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšæŸäº‹*/</span></div><div class="line">     <span class="keyword">return</span> config;</div><div class="line">   &#125;ï¼Œ<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">     <span class="comment">/*è¯·æ±‚é”™è¯¯æ—¶åšäº›äº‹*/</span></div><div class="line">     <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">   &#125;);</div><div class="line"> </div><div class="line"><span class="comment">/*æ·»åŠ å“åº”æ‹¦æˆªå™¨*/</span></div><div class="line">axios.interceptors.response.use(<span class="function"><span class="keyword">function</span>(<span class="params">response</span>)</span>&#123;</div><div class="line">     <span class="comment">/*å¯¹å“åº”æ•°æ®åšäº›äº‹*/</span></div><div class="line">      <span class="keyword">return</span> response;</div><div class="line">   &#125;ï¼Œ<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</div><div class="line">     <span class="comment">/*è¯·æ±‚é”™è¯¯æ—¶åšäº›äº‹*/</span></div><div class="line">     <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">   &#125;);</div></pre></td></tr></table></figure>
<p>å¦‚æœä½ ä»¥åå¯èƒ½éœ€è¦åˆ é™¤æ‹¦æˆªå™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myInterceptor = axios.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">/*...*/</span>&#125;);</div><div class="line">axios.interceptors.request.eject(myInterceptor);</div></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥å°†æ‹¦æˆªå™¨æ·»åŠ åˆ°axiosçš„è‡ªå®šä¹‰å®ä¾‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> instance = axios.create();</div><div class="line">instance.interceptors.request.use(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;<span class="comment">/*...*/</span>&#125;);</div></pre></td></tr></table></figure>
<h1 id="æ¶ˆé™¤"><a href="#æ¶ˆé™¤" class="headerlink" title="æ¶ˆé™¤"></a>æ¶ˆé™¤</h1><p>æ‚¨å¯ä»¥ä½¿ç”¨å–æ¶ˆä»¤ç‰Œå–æ¶ˆè¯·æ±‚ã€‚</p>
<blockquote>
<p>axios cancel token APIåŸºäºå¯å–æ¶ˆçš„promiseæè®®ï¼Œç›®å‰å¤„äºé˜¶æ®µ1ã€‚</p>
</blockquote>
<p>æ‚¨å¯ä»¥ä½¿ç”¨CancelToken.sourceå·¥å‚åˆ›å»ºä¸€ä¸ªå–æ¶ˆä»¤ç‰Œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> CancelToken = axios.CancelToken;</div><div class="line"><span class="keyword">var</span> source = CancelToken.source();</div><div class="line">axios.get(<span class="string">'/user/12345'</span>, &#123;</div><div class="line">  <span class="attr">cancelToken</span>: source.token</div><div class="line">&#125;).catch(<span class="function"><span class="keyword">function</span>(<span class="params">thrown</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (axios.isCancel(thrown)) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Request canceled'</span>, thrown.message);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">/* å¤„ç†é”™è¯¯*/</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">/*å–æ¶ˆè¯·æ±‚(æ¶ˆæ¯å‚æ•°æ˜¯å¯é€‰çš„)*/</span></div><div class="line">source.cancel(<span class="string">'æ“ä½œè¢«ç”¨æˆ·å–æ¶ˆã€‚'</span>);</div></pre></td></tr></table></figure></p>
<p>æ‚¨è¿˜å¯ä»¥é€šè¿‡å°†æ‰§è¡Œå™¨å‡½æ•°ä¼ é€’ç»™CancelTokenæ„é€ å‡½æ•°æ¥åˆ›å»ºå–æ¶ˆä»¤ç‰Œï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> CancelToken = axios.CancelToken;</div><div class="line"><span class="keyword">var</span> cancel;</div><div class="line"> </div><div class="line">axios.get(<span class="string">'/ user / 12345'</span>ï¼Œ&#123;</div><div class="line">   cancelTokenï¼š<span class="keyword">new</span> CancelToken(<span class="function"><span class="keyword">function</span> <span class="title">executor</span>(<span class="params">c</span>)</span>&#123;</div><div class="line">     <span class="comment">/*ä¸€ä¸ªæ‰§è¡Œå™¨å‡½æ•°æ¥æ”¶ä¸€ä¸ªå–æ¶ˆå‡½æ•°ä½œä¸ºå‚æ•°*/</span></div><div class="line">     cancel = c;</div><div class="line">   &#125;)</div><div class="line">&#125;);</div><div class="line"><span class="comment">/* å–æ¶ˆè¯·æ±‚*/</span></div><div class="line">clear();</div></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ç›¸åŒçš„å–æ¶ˆä»¤ç‰Œå–æ¶ˆå‡ ä¸ªè¯·æ±‚ã€‚</p>
</blockquote>
<h1 id="ä½¿ç”¨application-x-www-form-urlencodedæ ¼å¼"><a href="#ä½¿ç”¨application-x-www-form-urlencodedæ ¼å¼" class="headerlink" title="ä½¿ç”¨application / x-www-form-urlencodedæ ¼å¼"></a>ä½¿ç”¨application / x-www-form-urlencodedæ ¼å¼</h1><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œaxioså°†JavaScriptå¯¹è±¡åºåˆ—åŒ–ä¸ºJSONã€‚ è¦ä»¥åº”ç”¨ç¨‹åº/ x-www-form-urlencodedæ ¼å¼å‘é€æ•°æ®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹é€‰é¡¹ä¹‹ä¸€ã€‚</p>
<p>æµè§ˆå™¨</p>
<p>åœ¨æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨URLSearchParams APIï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> params = <span class="keyword">new</span> URLSearchParams();</div><div class="line">params.append(<span class="string">'param1'</span>, <span class="string">'value1'</span>);</div><div class="line">params.append(<span class="string">'param2'</span>, <span class="string">'value2'</span>);</div><div class="line">axios.post(<span class="string">'/foo'</span>, params);</div></pre></td></tr></table></figure>
<blockquote>
<p>è¯·æ³¨æ„ï¼Œæ‰€æœ‰æµè§ˆå™¨éƒ½ä¸æ”¯æŒURLSearchParamsï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªpolyfillå¯ç”¨(ç¡®ä¿polyfillå…¨å±€ç¯å¢ƒ)ã€‚<br>æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨qsåº“å¯¹æ•°æ®è¿›è¡Œç¼–ç ï¼š</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> qs = <span class="built_in">require</span>(<span class="string">'qs'</span>);</div><div class="line">axios.post(<span class="string">'/foo'</span>, qs.stringify(&#123; <span class="string">'bar'</span>: <span class="number">123</span> &#125;);</div></pre></td></tr></table></figure>
<h2 id="Node-js"><a href="#Node-js" class="headerlink" title="Node.js"></a>Node.js</h2><p>åœ¨node.jsä¸­ï¼Œå¯ä»¥ä½¿ç”¨querystringæ¨¡å—ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> querystring = <span class="built_in">require</span>(<span class="string">'querystring'</span>);</div><div class="line">axios.post(<span class="string">'http:/*something.com/'</span>, querystring.stringify(&#123; <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;);</div></pre></td></tr></table></figure></p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨qsåº“ã€‚</p>
<h1 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h1><p>axios ä¾èµ–æœ¬æœºè¦æ”¯æŒES6 Promiseå®ç°ã€‚ å¦‚æœæ‚¨çš„ç¯å¢ƒä¸æ”¯æŒES6 Promisesï¼Œæ‚¨å¯ä»¥ä½¿ç”¨polyfillã€‚<br>axiosåŒ…æ‹¬TypeScriptå®šä¹‰ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</div><div class="line">axios.get(<span class="string">'/user?ID=12345'</span>);</div></pre></td></tr></table></figure>
<p>axiosåœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå—åˆ°Angularæä¾›çš„$httpæœåŠ¡çš„å¯å‘ã€‚ æœ€ç»ˆï¼ŒaxiosåŠªåŠ›æä¾›ä¸€ä¸ªåœ¨Angularå¤–ä½¿ç”¨çš„ç‹¬ç«‹çš„$http-likeæœåŠ¡ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> axios </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Vuex2ä¸Axioså¼€å‘]]></title>
      <url>http://ygxdxx.coding.me/2017/02/01/Vuex2%E4%B8%8EAxios%E5%BC%80%E5%8F%91/</url>
      <content type="html"><![CDATA[<blockquote>
<p>æ€»ç»“ç¬”è€…æœ€è¿‘åœ¨é¡¹ç›®ä¸­ä½¿ç”¨Vuex2å’ŒAxiosçš„æ€»ç»“å’Œå°æŠ€å·§ï¼Œæ–¹ä¾¿æ—¥åæŸ¥çœ‹ã€‚æœ¬äººèƒ½åŠ›æœ‰é™ï¼Œå¦‚æœ‰é”™è¯¯è¿˜è¯·å¤§å¤§ä»¬æŒ‡æ­£æ¢è®¨ğŸ˜­ã€‚</p>
</blockquote>
<h1 id="é˜…è¯»å‰é¡»çŸ¥"><a href="#é˜…è¯»å‰é¡»çŸ¥" class="headerlink" title="é˜…è¯»å‰é¡»çŸ¥"></a>é˜…è¯»å‰é¡»çŸ¥</h1><p>æ¥ä¸Šä¸€ç¯‡çš„<a href="https://ygxdxx.coding.me/2017/01/29/Axios%E7%9A%84%E9%85%8D%E7%BD%AE/">Axiosçš„é…ç½®</a>ï¼Œé˜…è¯»æœ¬æ–‡é»˜è®¤æ‚¨å·²ç»æŒæ¡äº†Vuex2çš„åŸºæœ¬è¯­æ³•ã€Axiosçš„ä½¿ç”¨é…ç½®ä¸æ–¹æ³•ã€Promiseçš„åŸºæœ¬è¯­æ³•ã€‚ï¼ˆä¸‹é¢å°†æ”¾å‡ºå‚è€ƒé“¾æ¥æ–¹ä¾¿å¤§å®¶åœ¨æœ‰ä¸æ˜ç™½çš„åœ°æ–¹æŸ¥çœ‹ï¼‰æ­¤ç¯‡ä¸»è¦å™è¿°æˆ‘åœ¨å®é™…é¡¹ç›®è¿‡ç¨‹ä¸­Vuex2å’ŒAxiosçš„ç»„åˆæ“ä½œã€‚</p>
<p>å‚è€ƒï¼š</p>
<ul>
<li><a href="https://vuex.vuejs.org/zh-cn/index.html" target="_blank" rel="external">Vueå•å‘æ•°æ®æµ-Vuex2</a></li>
<li><a href="https://github.com/mzabriskie/axioss://vuex.vuejs.org/zh-cn/index.html" target="_blank" rel="external">Ajaxåº“-Axios</a></li>
<li><a href="http://www.jianshu.com/p/063f7e490e9aoss://vuex.vuejs.org/zh-cn/index.html" target="_blank" rel="external">Promiseä»‹ç»</a></li>
</ul>
<h2 id="Vuex2ä¸­çš„Actions"><a href="#Vuex2ä¸­çš„Actions" class="headerlink" title="Vuex2ä¸­çš„Actions"></a>Vuex2ä¸­çš„Actions</h2><p>åœ¨Vuex1ä¸­actionséƒ½å¯ä»¥ç»Ÿä¸€ä½¿ç”¨<code>dispatch</code>å»è§¦å‘<code>mutation</code>ï¼Œé‚£æ—¶å€™å»å¼‚æ­¥è¿™ç§æ•°æ®æµæ²¡ä»€ä¹ˆè®¤è¯†ã€‚åœ¨Vuex2ä¸­è§„å®šäº†,åŒæ­¥çš„æ–¹æ³•ä½¿ç”¨<code>commit</code>å»æäº¤<code>mutation</code>ï¼Œå¼‚æ­¥çš„æ–¹æ³•ï¼ˆå¦‚æ¥å£è¯·æ±‚ï¼Œå®Œæˆæ¥å£è¯·æ±‚åçš„æ“ä½œï¼‰åªèƒ½é€šè¿‡åˆ†å‘actionå»è§¦å‘ï¼Œå³ä½¿ç”¨<code>dispatch</code>ã€‚</p>
<p><img src="https://vuex.vuejs.org/zh-cn/images/flow.png" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"></p>
<p>è¿™é‡Œä¸ç»åæ§½2å¥ï¼ŒVuex2çš„Apiè¿˜æ˜¯è›®äººæ€§åŒ–çš„ï¼Œå¯¹æ¯”Reduxä¸ºäº†ç”¨å¥½å•å‘æ•°æ®æµï¼Œä¸å¾—ä¸å¼•å…¥ä¸€å¤§å †è¯¸å¦‚<code>react-redux</code>ã€<code>redux-saga</code>ã€<code>redux-thunk</code>â€¦ï¼Œå¯¹æ–°ä¸Šæ‰‹çš„å°ç™½æ¥è¯´ç®€ç›´æ˜¯ä¸€è„¸è’™è”½ã€‚ä¸Šé¢è¿™äº›åº“æ‰€å¸¦çš„åŠŸèƒ½ï¼Œç”¨Vuex2éƒ½å¯ä»¥å®Œæˆï¼ˆæ‰‹åŠ¨éª„å‚²ï¼‰ï¼Œå½“ç„¶Vuex2ä¹Ÿæ˜¯ç«™åœ¨è¿™äº›å·¨äººçš„è‚©è†€ä¸Šã€‚</p>
<p>ä¸‹é¢æ¥çœ‹ä¸‹<code>vuex2</code>ä¸­å…³äºactionsçš„API<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ç±»å‹: &#123; [type: string]: <span class="built_in">Function</span> &#125;</div><div class="line"></div><div class="line">åœ¨ store ä¸Šæ³¨å†Œ actionã€‚å¤„ç†å‡½æ•°æ¥å—ä¸€ä¸ª context å¯¹è±¡ï¼ŒåŒ…å«ä»¥ä¸‹å±æ€§ï¼š</div><div class="line"></div><div class="line">&#123;</div><div class="line">  state,     <span class="comment">// ç­‰åŒäº store.state, è‹¥åœ¨æ¨¡å—ä¸­åˆ™ä¸ºå±€éƒ¨çŠ¶æ€</span></div><div class="line">  rootState, <span class="comment">// ç­‰åŒäº store.state, åªå­˜åœ¨äºæ¨¡å—ä¸­</span></div><div class="line">  commit,    <span class="comment">// ç­‰åŒäº store.commit</span></div><div class="line">  dispatch,  <span class="comment">// ç­‰åŒäº store.dispatch</span></div><div class="line">  getters    <span class="comment">// ç­‰åŒäº store.getters</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="Axiosçš„é…ç½®"><a href="#Axiosçš„é…ç½®" class="headerlink" title="Axiosçš„é…ç½®"></a>Axiosçš„é…ç½®</h2><p>è¿™ä¸ªæ˜¯æˆ‘é¡¹ç›®å†…Axiosçš„é…ç½®ï¼Œä¸»è¦åšäº†ä¸‹é¢å‡ ä»¶äº‹æƒ…</p>
<ol>
<li>5ç§’çš„è¶…æ—¶éªŒè¯</li>
<li>POSTçš„è®¾ç½®</li>
<li>ç»Ÿä¸€çš„responseå°è£…ã€‚æˆ‘é€šè¿‡æ¥å£ä¼ å›çš„CODEç å»åˆ¤æ–­è¯¥è¯·æ±‚æ˜¯å¦æ­£ç¡®<br>å¦‚æœæƒ³å»çœ‹æ›´è¯¦ç»†çš„è§£æå¯ä»¥é€šè¿‡<a href="https://ygxdxx.coding.me/2017/01/29/Axios%E7%9A%84%E9%85%8D%E7%BD%AE/">Axiosçš„é…ç½®</a></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></div><div class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> _ <span class="keyword">from</span> <span class="string">'./whole'</span>    <span class="comment">//alert</span></div><div class="line"></div><div class="line">axios.defaults.timeout = <span class="number">5000</span>;</div><div class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</div><div class="line">axios.defaults.baseURL = <span class="string">'http://xxx.xxx.com'</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">//POSTä¼ å‚åºåˆ—åŒ–</span></div><div class="line">axios.interceptors.request.use(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span>(config.method  === <span class="string">'post'</span>)&#123;</div><div class="line">    config.data = qs.stringify(config.data);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> config;</div><div class="line">&#125;,(error) =&gt;&#123;</div><div class="line">   _.toast(<span class="string">"é”™è¯¯çš„ä¼ å‚"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//codeçŠ¶æ€ç 200åˆ¤æ–­</span></div><div class="line">axios.interceptors.response.use(<span class="function">(<span class="params">res</span>) =&gt;</span>&#123;</div><div class="line">  <span class="keyword">if</span>(res.data.code != <span class="string">'200'</span>)&#123;</div><div class="line">    _.toast(res.data.msg);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(res);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;, (error) =&gt; &#123;</div><div class="line">  _.toast(<span class="string">"ç½‘ç»œå¼‚å¸¸"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios;</div></pre></td></tr></table></figure>
<h2 id="å®Œæˆä¸€ä¸ªè¯·æ±‚æ“ä½œ"><a href="#å®Œæˆä¸€ä¸ªè¯·æ±‚æ“ä½œ" class="headerlink" title="å®Œæˆä¸€ä¸ªè¯·æ±‚æ“ä½œ"></a>å®Œæˆä¸€ä¸ªè¯·æ±‚æ“ä½œ</h2><p>ä¸‹é¢ä»‹ç»ä¸€ä¸ªç™»é™†actionçš„æ“ä½œï¼Œ</p>
<ol>
<li>åœ¨æ¥å£å‘èµ·è¯·æ±‚æ—¶è·³å‡ºloading</li>
<li>æ¥å£è¯·æ±‚æˆåŠŸç»“æŸloadingï¼Œå¹¶ä¿å­˜æ•°æ®è¿›å…¥store</li>
<li>æ¥å£è¯·æ±‚å¤±è´¥æŠ›å‡ºå¼‚å¸¸ï¼Œç»“æŸloadingã€‚</li>
<li>è¿”å›ä¸€ä¸ªPromiseå¯¹è±¡ï¼Œæ–¹ä¾¿ç»§ç»­æ“ä½œã€‚</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> login = <span class="function">(<span class="params">&#123; commit &#125;,params</span>) =&gt;</span> &#123;</div><div class="line">  _.busy();               <span class="comment">//lodingå¼€å§‹</span></div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span> &#123; </div><div class="line">    axios(&#123;</div><div class="line">      <span class="attr">method</span>:<span class="string">'get'</span>,</div><div class="line">      <span class="attr">url</span>: <span class="string">'teacher/login'</span>,</div><div class="line">      <span class="attr">params</span>: &#123;</div><div class="line">        <span class="attr">moblie</span>:params.mobile,</div><div class="line">        <span class="attr">password</span>:params.password,</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">        commit(types.LOGIN,response.data.data); <span class="comment">//è·å¾—çš„æ•°æ®é€šè¿‡mutationï¼Œå­˜å…¥storeä¸­</span></div><div class="line">        _.leave();  <span class="comment">//lodingç»“æŸ</span></div><div class="line">        resolve(response);</div><div class="line">    &#125;)</div><div class="line">    .catch(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</div><div class="line">      _.leave();  <span class="comment">//lodingç»“æŸ</span></div><div class="line">    &#125;)</div><div class="line">  &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> mutations = &#123;</div><div class="line">  [types.LOGIN](state, data)&#123;</div><div class="line">    state.token = data.token;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//è°ƒç”¨action</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> &#123; mapActions,mapGetters  &#125; <span class="keyword">from</span> <span class="string">'vuex'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">methods</span>:&#123;</div><div class="line">    ...mapActions([<span class="string">'login'</span>]),                   <span class="comment">//æ³¨å…¥action</span></div><div class="line">    _login()&#123;</div><div class="line">      <span class="keyword">let</span> params = &#123;</div><div class="line">        <span class="attr">mobile</span>:<span class="keyword">this</span>.mobile,</div><div class="line">        <span class="attr">pwd</span>:<span class="keyword">this</span>.password</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">this</span>.login(params).</div><div class="line">      then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</div><div class="line">          <span class="keyword">this</span>.$router.replace(<span class="string">'/main/index'</span>);          <span class="comment">//æ­£ç¡®å®Œæˆåè¿›å…¥ä¸»é¡µ</span></div><div class="line">      &#125;)</div><div class="line">      .catch(<span class="function">(<span class="params">error</span>)=&gt;</span>&#123;                                 <span class="comment">//é”™è¯¯åˆ™æ¸…ç©ºå¯†ç æ–‡æœ¬æ¡†</span></div><div class="line">          <span class="comment">//å¯ä»¥åœ¨è¿™é‡Œå¯¹Errorè¿›è¡Œæ•è·ï¼Œç„¶åæ ¹æ®é”™è¯¯ç±»å‹è¿›è¡Œç›¸å¯¹åº”çš„å¤„ç†</span></div><div class="line">          <span class="keyword">this</span>.pwd = <span class="string">''</span>;                           </div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;</div></pre></td></tr></table></figure>
<h2 id="ä¸€ç‚¹è¯´æ˜"><a href="#ä¸€ç‚¹è¯´æ˜" class="headerlink" title="ä¸€ç‚¹è¯´æ˜"></a>ä¸€ç‚¹è¯´æ˜</h2><p>å› ä¸ºåœ¨Vuex2ä¸­actionå¯ä»¥ç›´æ¥æ‹¿åˆ°Storeçš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>rootState</code>è¿™ä¸ªå‚æ•°æ‹¿åˆ°æ ¹çš„storeå€¼ï¼Œé€šè¿‡<code>state</code>æ‹¿åˆ°å½“å‰æ¨¡å—ä¸­storeçš„å€¼<br>éƒ½æ²¡å¿…è¦åœ¨ä»getteré‡Œæ‹¿åˆ°å€¼ï¼Œç„¶åé€šè¿‡paramsçš„æ–¹å¼ä¼ å…¥ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> xxx = <span class="function">(<span class="params">&#123;state,rootState,commit&#125;</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>)=&gt;</span> &#123; </div><div class="line">    axios(&#123;</div><div class="line">      <span class="attr">method</span>:<span class="string">'get'</span>,</div><div class="line">      <span class="attr">url</span>: <span class="string">'teacher/workbook/class/exercise'</span>,</div><div class="line">      <span class="attr">params</span>: &#123;</div><div class="line">        <span class="string">"token"</span>:rootState.login.token,          <span class="comment">//ä»storeæ ¹ä¸­æ‹¿åˆ°æ•°æ®</span></div><div class="line">        <span class="string">"classCode"</span>:state.code,                 <span class="comment">//ä»å½“å‰æ¨¡å—ä¸­æ‹¿åˆ°æ•°æ®</span></div><div class="line">        <span class="string">"chapterId"</span>:rootState.route.params.chapterId</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    .then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">      commit(types.WORKBOOK_CLASS_EXERCISE,response.data.data)</div><div class="line">      resolve(response);</div><div class="line">    &#125;)</div><div class="line">  &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·æ˜¯ä¸æ˜¯æ›´æ–¹ä¾¿æˆ‘ä»¬å»å®¡æŸ¥actionçš„ä»£ç ï¼Ÿ</p>
]]></content>
      
        
        <tags>
            
            <tag> Vue </tag>
            
            <tag> Vuex2 </tag>
            
            <tag> Axios </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Axiosçš„é…ç½®]]></title>
      <url>http://ygxdxx.coding.me/2017/01/29/Axios%E7%9A%84%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<blockquote>
<p>ä»¥å‰å†™Vueé¡¹ç›®çš„æ—¶å€™éƒ½æ˜¯ä½¿ç”¨vue-resourceåšä¸ºé¡¹ç›®ajaxåº“ï¼Œåœ¨11æœˆä»½çš„æŸä¸€å¤©å°¤å¤§å¾®åšçš„æ›´æ–°è¡¨ç¤ºajaxçš„åº“åº”è¯¥æ˜¯é€šç”¨çš„ï¼Œæ”¾å¼ƒäº†å¯¹vue-resourceçš„æŠ€æœ¯æ”¯æŒï¼Œæ¨èä½¿ç”¨<a href="https://github.com/mzabriskie/axios" target="_blank" rel="external">axios</a>ã€‚</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/1987062-b3255d564903d3d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æ­¤å¤„è¾“å…¥å›¾ç‰‡çš„æè¿°"><br>æ—¢ç„¶å°¤å¤§æ¨èçš„åº”è¯¥æœ‰è¿‡äººä¹‹å¤„ï¼Œå¥½å§äºæ˜¯åœ¨æ–°çš„é¡¹ç›®ä¸Šå¼€å§‹ä½¿ç”¨Axios,å¼€å¯è¿™æ®µå­¦ä¹ ï¼ˆè¸©å‘ï¼‰çš„å†ç¨‹ã€‚</p>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install axios</div></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h1><p>Axioså’Œå…¶ä»–çš„ajaxåº“éƒ½æ˜¯å¾ˆç±»ä¼¼çš„ï¼Œæä¾›äº†2ç§ä½¿ç”¨çš„æ–¹å¼ä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨å®ä¾‹æ–¹æ³•çš„å¦‚ï¼š<br>ä¸‹é¢æ˜¯å®ä¾‹çš„æ‰€æœ‰å¯ç”¨æ–¹æ³•ï¼Œæ–¹æ³•ä¸­çš„configä¼šä¸axioså®ä¾‹ä¸­çš„configåˆå¹¶ã€‚ï¼ˆå®ä¾‹å¯ä»¥å°†ä¸€äº›é€šç”¨çš„configå…ˆé…ç½®å¥½ï¼‰<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//axios.get</span></div><div class="line"><span class="comment">//axios.post</span></div><div class="line"></div><div class="line">axios.get(<span class="string">'/user?ID=12345'</span>)</div><div class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(response);</div><div class="line">  &#125;)</div><div class="line">  .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(error);</div><div class="line">  &#125;);</div></pre></td></tr></table></figure></p>
<h1 id="Config-é…ç½®"><a href="#Config-é…ç½®" class="headerlink" title="Config é…ç½®"></a>Config é…ç½®</h1><p>Axiosçš„é…ç½®å‚æ•°å¾ˆå¤šï¼Œæˆ‘ä»¬æ¥ä¸€ä¸€äº†è§£</p>
<ul>
<li>url â€”â€” ç”¨æ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„url</li>
<li>method â€”â€” è¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤æ˜¯GETæ–¹æ³•</li>
<li>baseURL â€”â€” åŸºç¡€URLè·¯å¾„ï¼Œå‡å¦‚urlä¸æ˜¯ç»å¯¹è·¯å¾„ï¼Œå¦‚<a href="https://some-domain.com/api/v1/login?name=jack,é‚£ä¹ˆå‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„URLå°†ä¼šæ˜¯baseURL" target="_blank" rel="external">https://some-domain.com/api/v1/login?name=jack,é‚£ä¹ˆå‘æœåŠ¡å™¨å‘é€è¯·æ±‚çš„URLå°†ä¼šæ˜¯baseURL</a> + urlã€‚</li>
<li>transformRequest â€”â€” transformRequestæ–¹æ³•å…è®¸åœ¨è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ä¹‹å‰ä¿®æ”¹è¯¥è¯·æ±‚ï¼Œæ­¤æ–¹æ³•åªé€‚ç”¨äºPUTã€POSTå’ŒPATCHæ–¹æ³•ä¸­ã€‚è€Œä¸”ï¼Œæ­¤æ–¹æ³•æœ€åå¿…é¡»è¿”å›ä¸€ä¸ªstringã€ArrayBufferæˆ–è€…Streamã€‚</li>
<li>transformResponse â€”â€” transformResponseæ–¹æ³•å…è®¸åœ¨æ•°æ®ä¼ é€’åˆ°then/catchä¹‹å‰ä¿®æ”¹responseæ•°æ®ã€‚æ­¤æ–¹æ³•æœ€åä¹Ÿè¦è¿”å›æ•°æ®ã€‚</li>
<li>headers â€”â€” å‘é€è‡ªå®šä¹‰Headerså¤´æ–‡ä»¶ï¼Œå¤´æ–‡ä»¶ä¸­åŒ…å«äº†httpè¯·æ±‚çš„å„ç§ä¿¡æ¯ã€‚</li>
<li>params â€”â€” paramsæ˜¯å‘é€è¯·æ±‚çš„æŸ¥è¯¢å‚æ•°å¯¹è±¡ï¼Œå¯¹è±¡ä¸­çš„æ•°æ®ä¼šè¢«æ‹¼æ¥æˆurl?param1=value1&amp;param2=value2ã€‚<br>paramsSerializer â€”â€” paramså‚æ•°åºåˆ—åŒ–å™¨ã€‚</li>
<li>data â€”â€” dataæ˜¯åœ¨å‘é€POSTã€PUTæˆ–è€…PATCHè¯·æ±‚çš„æ•°æ®å¯¹è±¡ã€‚</li>
<li>timeout â€”â€” è¯·æ±‚è¶…æ—¶è®¾ç½®ï¼Œå•ä½ä¸ºæ¯«ç§’</li>
<li>withCredentials â€”â€” è¡¨æ˜æ˜¯å¦æœ‰è·¨åŸŸè¯·æ±‚éœ€è¦ç”¨åˆ°è¯ä¹¦</li>
<li>adapter â€”â€” adapterå…è®¸ç”¨æˆ·å¤„ç†æ›´æ˜“äºæµ‹è¯•çš„è¯·æ±‚ã€‚è¿”å›ä¸€ä¸ªPromiseå’Œä¸€ä¸ªæœ‰æ•ˆçš„response</li>
<li>auth â€”â€” authè¡¨æ˜æä¾›å‡­è¯ç”¨äºå®Œæˆhttpçš„èº«ä»½éªŒè¯ã€‚è¿™å°†ä¼šåœ¨headersä¸­è®¾ç½®ä¸€ä¸ªAuthorizationæˆæƒä¿¡æ¯ã€‚è‡ªå®šä¹‰Authorizationæˆæƒè¦è®¾ç½®åœ¨headersä¸­ã€‚</li>
<li>responseType â€”â€” è¡¨ç¤ºæœåŠ¡å™¨å°†è¿”å›å“åº”çš„æ•°æ®ç±»å‹ï¼Œæœ‰arraybufferã€blobã€documentã€jsonã€textã€streamè¿™6ä¸ªç±»å‹ï¼Œé»˜è®¤æ˜¯jsonç±»ä¼¼æ•°æ®ã€‚</li>
<li>xsrfCookieName â€”â€” ç”¨ä½œ xsrf token å€¼çš„ cookie åç§°</li>
<li>xsrfHeaderName â€”â€” å¸¦æœ‰ xsrf token å€¼ http head åç§°</li>
<li>onUploadProgress â€”â€” å…è®¸åœ¨ä¸Šä¼ è¿‡ç¨‹ä¸­çš„åšä¸€äº›æ“ä½œ</li>
<li>onDownloadProgress â€”â€” å…è®¸åœ¨ä¸‹è½½è¿‡ç¨‹ä¸­çš„åšä¸€äº›æ“ä½œ</li>
<li>maxContentLength â€”â€” å®šä¹‰äº†æ¥æ”¶åˆ°çš„responseå“åº”æ•°æ®çš„æœ€å¤§é•¿åº¦ã€‚</li>
<li>validateStatus â€”â€” validateStatuså®šä¹‰äº†æ ¹æ®HTTPå“åº”çŠ¶æ€ç å†³å®šæ˜¯å¦æ¥æ”¶æˆ–æ‹’ç»è·å–åˆ°çš„promiseã€‚å¦‚æœ validateStatus è¿”å› true (æˆ–è®¾ç½®ä¸º null æˆ– undefined ),promiseå°†è¢«æ¥æ”¶;å¦åˆ™,promiseå°†è¢«æ‹’ç»ã€‚</li>
<li>maxRedirects â€”â€” maxRedirectså®šä¹‰äº†åœ¨node.jsä¸­redirectçš„æœ€å¤§å€¼ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œåˆ™æ²¡æœ‰redirectã€‚</li>
<li>httpAgent â€”â€” å®šä¹‰åœ¨ä½¿ç”¨httpè¯·æ±‚æ—¶çš„ä»£ç†</li>
<li>httpsAgent â€”â€” å®šä¹‰åœ¨ä½¿ç”¨httpsè¯·æ±‚æ—¶çš„ä»£ç†</li>
<li>proxy â€”â€” proxyå®šä¹‰ä»£ç†æœåŠ¡å™¨çš„ä¸»æœºåå’Œç«¯å£ï¼Œauth</li>
<li>cancelToken â€”â€” cancelTokenå®šä¹‰ä¸€ä¸ª cancel token ç”¨äºå–æ¶ˆè¯·æ±‚</li>
</ul>
<h1 id="Response-è¿”å›"><a href="#Response-è¿”å›" class="headerlink" title="Response è¿”å›"></a>Response è¿”å›</h1><p>å½“æˆ‘ä»¬ajaxè·å–æ•°æ®æˆåŠŸåä¼šè¿”å›ä¸€ä¸ªresponseå¯¹è±¡ï¼Œå®ƒåŒ…å«äº†ä»¥ä¸‹å†…å®¹<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">&#123;</div><div class="line">  <span class="comment">// æœåŠ¡å™¨è¿”å›çš„æ•°æ®</span></div><div class="line">  data: &#123;&#125;,</div><div class="line">  <span class="comment">// HTTPçŠ¶æ€å—</span></div><div class="line">  status: <span class="number">200</span>,</div><div class="line">  <span class="comment">// æœåŠ¡å™¨è¿”å›çš„æ¶ˆæ¯</span></div><div class="line">  statusText: <span class="string">'OK'</span>,</div><div class="line">  <span class="comment">// è¿”å›å¤´</span></div><div class="line">  headers: &#123;&#125;,</div><div class="line">  <span class="comment">// åœ¨è¿”å›æˆ‘ä»¬çš„é…ç½®</span></div><div class="line">  config: &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h1 id="ç»Ÿä¸€Configé…ç½®"><a href="#ç»Ÿä¸€Configé…ç½®" class="headerlink" title="ç»Ÿä¸€Configé…ç½®"></a>ç»Ÿä¸€Configé…ç½®</h1><p>åœ¨æ¥å£æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦åˆ‡æ¢çº¿ä¸Šç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒï¼Œè¿™é‡Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡Configæ¥é…ç½®ï¼Œè¿™æ ·æˆ‘ä»¬æ‰€æœ‰çš„å‘èµ·çš„è¯·æ±‚éƒ½æ˜¯é€šè¿‡è¿™ä¸ªåŸºæœ¬çš„URLèµ°äº†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">axios.defaults.timeout = <span class="number">5000</span>;</div><div class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</div><div class="line">axios.defaults.baseURL = <span class="string">'http://www.xxxx.xxx/api'</span>;</div><div class="line"><span class="comment">// axios.defaults.baseURL = 'http://192.168.1.129:8383';</span></div></pre></td></tr></table></figure>
<h1 id="Interceptors-æ‹¦æˆªå™¨"><a href="#Interceptors-æ‹¦æˆªå™¨" class="headerlink" title="Interceptors æ‹¦æˆªå™¨"></a>Interceptors æ‹¦æˆªå™¨</h1><p>è¿™é‡Œæˆ‘å¿…é¡»é‡ç‚¹ä»‹ç»ï¼Œåœ¨æˆ‘ä»¬å‘èµ·å¤§é‡çš„è¯·æ±‚æ—¶å€™ï¼Œéœ€è¦å¯¹è¯·æ±‚åšç»Ÿä¸€çš„å¤„ç†é‚£å°±ç”¨åˆ°å®ƒäº†ã€‚ç¬”è€…åœ¨ä½¿ç”¨äº†<code>vue-resource</code>å’Œ<code>axios</code>ä¹‹åäº²èº«æ¯”è¾ƒï¼Œ<code>axios</code>çš„é…ç½®æ›´åŠ äººæ€§åŒ–ã€‚<br>å®˜æ–¹çš„APIä¸Šè¿™æ ·ä»‹ç»</p>
<blockquote>
<p>You can intercept requests or responses before they are handled by then or catch.<br>æ‚¨å¯ä»¥æ‹¦æˆªè¯·æ±‚æˆ–å“åº”ä¹‹å‰ï¼Œä»–ä»¬å¤„ç†çš„æ“ä½œæˆ–è€…å¼‚å¸¸</p>
</blockquote>
<h2 id="requestç»Ÿä¸€å¤„ç†æ“ä½œ"><a href="#requestç»Ÿä¸€å¤„ç†æ“ä½œ" class="headerlink" title="requestç»Ÿä¸€å¤„ç†æ“ä½œ"></a>requestç»Ÿä¸€å¤„ç†æ“ä½œ</h2><p>å¦‚æœæ˜¯POSTçš„è¯·æ±‚ï¼Œé…ç½®ä¸­å¯ä¸èƒ½ç”¨<code>params</code>å­—æ®µäº†ï¼Œéœ€è¦ä½¿ç”¨<code>data</code>å­—æ®µã€‚<br>è¿™é‡Œæœ‰ä¸ªå°åœ°æ–¹éœ€è¦æ³¨æ„ï¼ŒPOSTçš„ä¼ å‚éœ€è¦åºåˆ—åŒ–ï¼Œä¸ç„¶æœåŠ¡ç«¯ä¸ä¼šæ­£ç¡®çš„æ¥æ”¶å“¦ï¼Œä¼šæŠ¥é”™ã€‚æ‰€ä»¥è¿™é‡Œæˆ‘ä»¬è¦å¯¹requestçš„æ•°æ®è¿›è¡Œä¸€æ¬¡åºåˆ—åŒ–ã€‚è¿™é‡Œæˆ‘ç”¨äº†<code>qs</code>,å¤§å®¶éœ€è¦installä¸€ä¸‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></div><div class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span></div><div class="line"></div><div class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</div><div class="line"></div><div class="line"><span class="comment">//POSTä¼ å‚åºåˆ—åŒ–</span></div><div class="line">axios.interceptors.request.use(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span>(config.method  === <span class="string">'post'</span>)&#123;</div><div class="line">    config.data = qs.stringify(config.data);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> config;</div><div class="line">&#125;,(error) =&gt;&#123;</div><div class="line">   alert(<span class="string">"é”™è¯¯çš„ä¼ å‚"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="responseç»Ÿä¸€å¤„ç†æ“ä½œ"><a href="#responseç»Ÿä¸€å¤„ç†æ“ä½œ" class="headerlink" title="responseç»Ÿä¸€å¤„ç†æ“ä½œ"></a>responseç»Ÿä¸€å¤„ç†æ“ä½œ</h2><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥ç»Ÿä¸€çš„åœ¨å‘èµ·è¯·æ±‚å‰ï¼Œæˆ–è€…è·å¾—æ•°æ®ï¼Œå¯¹å…¶è¿›è¡Œç»Ÿä¸€çš„æ“ä½œã€‚è¿™ç‚¹éå¸¸çš„é«˜æ•ˆï¼Œåœ¨ç¬”è€…çš„é¡¹ç›®ä¸­ï¼Œæ¥å£ä¼šè¿”å›ä¸€ä¸ªcode,å°±å’Œå¾®ä¿¡APIä¸€æ ·ï¼Œcodeä¸º200ä»£è¡¨è¿”å›è¯·æ±‚æ•°æ®æ­£ç¡®ä¸ºå…¶å®ƒæ—¶å°±è‡ªåŠ¨è·³å‡ºå¼¹çª—æ‰“å°æ¶ˆæ¯å³å¯ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//codeçŠ¶æ€ç 200åˆ¤æ–­</span></div><div class="line">axios.interceptors.response.use(<span class="function">(<span class="params">res</span>) =&gt;</span>&#123;</div><div class="line">  <span class="keyword">if</span>(res.data.code != <span class="string">'200'</span>)&#123;</div><div class="line">    alert(res.data.msg);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(res);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;, (error) =&gt; &#123;</div><div class="line">  alert(<span class="string">"ç½‘ç»œå¼‚å¸¸"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>å¦‚æœå‘ç”Ÿè¿™äº›é”™è¯¯äº†æˆ‘è¦ç»“æŸå½“å‰çš„Promiseæ‰€ä»¥è¿”å›ä¸€ä¸ª<code>Promise.reject(res)</code>ï¼Œåœæ­¢Promiseé˜Ÿåˆ—ä¸‹é¢çš„æ“ä½œ,å¦‚æœæœ‰å¯¹äºPromiseä¸ç†Ÿæ‚‰çš„ç«¥é‹è¯·è‡ªè¡Œæœç´¢<code>Promise</code>(è¿™é‡Œè¿˜é‡åˆ°äº†ä¸€ä¸ªå°å‘æœ€åä¼šä»‹ç»)</p>
<h1 id="æˆ‘çš„é…ç½®"><a href="#æˆ‘çš„é…ç½®" class="headerlink" title="æˆ‘çš„é…ç½®"></a>æˆ‘çš„é…ç½®</h1><p>å¥½äº†ä»‹ç»äº†è¿™ä¹ˆå¤šä»‹ç»ä¸‹æˆ‘çš„axiosé…ç½®çš„æ–‡ä»¶è®¾ç½®å§,è¿™ä¸ªæ–‡ä»¶åæ˜¯<code>config/http.js</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span></div><div class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">'qs'</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> _ <span class="keyword">from</span> <span class="string">'./whole'</span></div><div class="line"></div><div class="line">axios.defaults.timeout = <span class="number">5000</span>;</div><div class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded;charset=UTF-8'</span>;</div><div class="line">axios.defaults.baseURL = <span class="string">'http://www.guinaben.com:8070'</span>;</div><div class="line"><span class="comment">// axios.defaults.baseURL = 'http://192.168.1.129:8383';</span></div><div class="line"></div><div class="line"><span class="comment">//POSTä¼ å‚åºåˆ—åŒ–</span></div><div class="line">axios.interceptors.request.use(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">if</span>(config.method  === <span class="string">'post'</span>)&#123;</div><div class="line">    config.data = qs.stringify(config.data);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> config;</div><div class="line">&#125;,(error) =&gt;&#123;</div><div class="line">   _.toast(<span class="string">"é”™è¯¯çš„ä¼ å‚"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//codeçŠ¶æ€ç 200åˆ¤æ–­</span></div><div class="line">axios.interceptors.response.use(<span class="function">(<span class="params">res</span>) =&gt;</span>&#123;</div><div class="line">  <span class="keyword">if</span>(res.data.code != <span class="string">'200'</span>)&#123;</div><div class="line">    _.toast(res.data.msg);</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(res);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> res;</div><div class="line">&#125;, (error) =&gt; &#123;</div><div class="line">  _.toast(<span class="string">"ç½‘ç»œå¼‚å¸¸"</span>);</div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios;</div></pre></td></tr></table></figure></p>
<p>å‘èµ·çš„è¯·æ±‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'config/http'</span></div><div class="line"></div><div class="line">axios(&#123;</div><div class="line">  <span class="attr">method</span>:<span class="string">'get'</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'xxxx/xxxxx'</span>,</div><div class="line">  <span class="attr">params</span>: &#123;</div><div class="line">    <span class="string">"textbook_id"</span>:id,</div><div class="line">    <span class="string">"token"</span>:token</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">.then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">  resolve(response);</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line">axios(&#123;</div><div class="line">  <span class="attr">method</span>:<span class="string">'post'</span>,</div><div class="line">  <span class="attr">url</span>: <span class="string">'teacher/pwd/resetByMobile'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">   <span class="string">"textbook_id"</span>:id,</div><div class="line">    <span class="string">"token"</span>:token</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">.then(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">    resolve(response);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h1 id="ä¸€å®šè¦çœ‹"><a href="#ä¸€å®šè¦çœ‹" class="headerlink" title="ä¸€å®šè¦çœ‹"></a>ä¸€å®šè¦çœ‹</h1><p>å› ä¸ºè¿™é‡Œæˆ‘ä½¿ç”¨çš„<code>Promise</code>,æ‰€ä»¥åœ¨å®‰å“4.4.3ä¸€ä¸‹çš„æ‰‹æœºè¿˜æ˜¯ä¸æ”¯æŒPromiseçš„ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ã€‚éœ€è¦å¼•å…¥<code>npm install babel-polyfill</code>å’Œ<code>npm install babel-runtime</code>ï¼Œåœ¨å…¥å£æ–‡ä»¶ä¸ŠåŠ ä¸Šå³å¯ã€‚<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> <span class="string">'babel-polyfill'</span></div></pre></td></tr></table></figure></p>
<h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>ä¸‹ä¸€ç¯‡å°†å¸¦æ¥Vuex2å’Œaxiosçš„é…åˆï¼Œå¸Œæœ›æ­¤ç¯‡èƒ½å¸¦ç»™å¤§å®¶å¸®åŠ©ã€‚</p>
]]></content>
      
        
        <tags>
            
            <tag> Axio </tag>
            
            <tag> Vue </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[å¼€åšç¬¬ä¸€ç¯‡çºªå¿µ]]></title>
      <url>http://ygxdxx.coding.me/2017/01/28/hello/</url>
      <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä»Šå¤©é¸¡å¹´çš„ç¬¬ä¸€å¤©ï¼Œè¯´äº†å¥½ä¹…æƒ³æ­å»ºè‡ªå·±çš„åšå®¢è®°å½•å¼€å‘çš„æ—¥å¸¸ï¼Œç»“æœä¸€æ‹–å†æ‹–Orzï¼ˆæ‹–å»¶ç—‡ä¼¤ä¸èµ·ï¼‰ã€‚ä»Šå¤©èŠ±äº†ä¸€ä¸‹åˆç»ˆäºæ­å»ºå®Œæˆã€‚</p>
<h2 id="ä½¿ç”¨æŠ€æœ¯"><a href="#ä½¿ç”¨æŠ€æœ¯" class="headerlink" title="ä½¿ç”¨æŠ€æœ¯"></a>ä½¿ç”¨æŠ€æœ¯</h2><p>1.Hexo<br>å‰ç«¯å»ºç«™ç¥å™¨ï¼Œè¿™é‡Œä¸å¤šè¯´äº†ã€‚<a href="https://hexo.io/zh-cn/docs/themes.html" target="_blank" rel="external">Hexoæ–‡æ¡£</a></p>
<p>2.ä¸»é¢˜<br>å½“æ—¶åœ¨å‘ç°è¿™ä¸ªä¸»é¢˜çš„æ—¶å€™æ˜¯æ¯”è¾ƒæƒŠè‰³çš„ï¼Œä¸ªäººæ¯”è¾ƒå–œæ¬¢è°·æ­Œçš„è¿™ç§é£æ ¼ï¼Œä½œè€…æ˜¯ä½å›½äººã€‚å¾ˆæ„Ÿè°¢æ— ç§çš„ä»˜å‡º<br><a href="https://material.viosey.com/" target="_blank" rel="external">Material Theme</a></p>
<p>3.Coding Pages<br>æœ¬æ¥æ‰“ç®—ä½¿ç”¨Github Pagesï¼Œæœ‰æ—¶å€™å¢™çš„å‰å®³ã€‚ä½¿ç”¨<a href="https://coding.net/help/doc/pages/index.html" target="_blank" rel="external">Coding Pages</a>åšä¸ºæ‰¿è½½ç½‘ç«™ã€‚<br>ä¸»è¦ä½¿ç”¨ã€Œç”¨æˆ· Pagesã€ç±»å‹ï¼Œåœ¨ä¸ªäººé¡¹ç›®é‡Œæ–°å»ºä¸€ä¸ªåä¸º {user_name}.coding.me çš„é¡¹ç›®ï¼Œç„¶åå°†Hexoä¸­ç”Ÿæˆçš„Publicæ–‡ä»¶å¤¹ä½œä¸ºGitçš„ä¸»ç›®å½•å³å¯ã€‚</p>
<h2 id="è¸©å‘"><a href="#è¸©å‘" class="headerlink" title="è¸©å‘"></a>è¸©å‘</h2><p>1._config.yml æ˜¯å…¨ç«™çš„æ§åˆ¶æ–‡ä»¶ï¼Œåœ¨é…ç½®çš„æ—¶å€™ï¼Œæœ‰æ—¶å€™ç¨ä¸æ³¨æ„å°†ä¸‹é¢ä»£ç å‰çš„ç©ºæ ¼åˆ æ‰äº†è¿è¡Œå°±ä¼šæŠ¥é”™ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//sourceå‰é¢æœ‰ä¸€ä¸ªç©ºæ ¼</span></div><div class="line">source_dir: source</div></pre></td></tr></table></figure></p>
<p>2.å¦‚æœå®‰è£…äº†æ–°çš„ä¸»é¢˜ï¼Œå°±éœ€è¦åˆ°è¯¥ä¸»é¢˜ä¸‹çš„_config.ymlå»é…ç½®ã€‚</p>
<h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>æ–°çš„ä¸€å¹´ï¼Œä»¥æ­¤ç¯‡å¼€å§‹ã€‚Fighting~</p>
]]></content>
      
        
        <tags>
            
            <tag> Hexo </tag>
            
            <tag> åšå®¢ </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
